<ng-container *ngIf="isLoading$ | async; else table">
  <mat-spinner></mat-spinner>
</ng-container>

<ng-template #table>
  <ng-container *ngIf="dataSource.data.length > 0; else noData">
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
      <ng-container [matColumnDef]="column.key" *ngFor="let column of columns">
        <th mat-header-cell *matHeaderCellDef>{{ column.key | titlecase }}</th>
        <td mat-cell *matCellDef="let element">
          <ng-container [ngSwitch]="column.type">
            <ng-container *ngIf="!element.isEdit; else editRow">
              <div *ngSwitchCase="types.TEXT">
                {{ element[column.key] }}
              </div>
              <div *ngSwitchCase="types.EDIT">
                <button mat-raised-button (click)="element.isEdit = !element.isEdit">
                  <mat-icon>edit</mat-icon> Edit
                </button>
              </div>
            </ng-container>
            <ng-template #editRow>
              <div *ngSwitchCase="types.TEXT">
                <mat-form-field appearance="fill">
                  <mat-label>{{ column.key | titlecase }}</mat-label>
                  <input matInput type="text" [(ngModel)]="element[column.key]" [placeholder]="element[column.key]" />
                </mat-form-field>
              </div>
              <div *ngSwitchCase="types.EDIT">
                <button mat-raised-button (click)="element.isEdit = !element.isEdit">
                  <mat-icon>done</mat-icon> Done
                </button>
              </div>
            </ng-template>
          </ng-container>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="getColumnsName()"></tr>
      <tr mat-row *matRowDef="let row; columns: getColumnsName()"></tr>
    </table>
  </ng-container>
  <ng-template #noData>
    <div fxLayout="row" fxLayoutAlign="center center">
      <h1>No data available. Check your backend & database statuses ! ðŸ’©</h1>
    </div>
  </ng-template>
</ng-template>


<mat-paginator [ngClass]="(isLoading$ | async) || dataSource.data.length === 0 ? 'hidden' : ''"
  [pageSizeOptions]="[5, 10]" showFirstLastButtons aria-label="Select page of periodic elements">
</mat-paginator>
